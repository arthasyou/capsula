

# 数据权限设计说明

在数据胶囊的结构中，权限部分只存放一个 **指针（acl_ref）**，用于指向数据库中的权限记录。

真正的权限模型（原子权属、分子权属、冲突规则、使用场景控制等）全部存储在数据库中，并由服务端代码逻辑来实现和判定。

### 设计思想
1. **胶囊负责最小绑定**  
   - 胶囊中包含 capsule_id、owner_pub、epoch、acl_ref。  
   - AEAD 的 AAD 中绑定 capsule_id | epoch | acl_ref 确保不可篡改。  

2. **权限逻辑在数据库**  
   - 原子/分子权属向量定义、规则校验、字段级可见性、黑盒处理、统计处理等均在数据库与服务端代码中实现。  
   - 胶囊本身不存储复杂权限信息，只存引用指针。  

3. **变更与撤销**  
   - 修改权限：更新数据库中的记录即可。  
   - 强撤销：提升 epoch、重加密 DEK，生成新的 keyring。  

4. **优点**  
   - 胶囊结构简单、稳定。  
   - 权限模型灵活，可迭代升级。  
   - 支持多场景挂载不同权限策略。

总结：**权限主要靠服务端逻辑和数据库来实现，数据胶囊只负责保存一个指向权限的最小引用。**